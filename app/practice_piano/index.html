<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Karl Hiner - Practice piano</title>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="author" content="Karl Hiner">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Bootstrap core CSS -->
    <link href="/components/bootstrap/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="/styles/main.css" rel="stylesheet">
  </head>

  <body>
    <div id="main_nav"></div>
    <div class="container main_contents">
      <div class="practice-list-parent">
        <ul class="vertical-list">
          <li id='five_finger' class="list-group-item">
            <div class="list-child practice-type">Five-finger pattern</div>
            <div class="list-child time-dropdown-group"></div>
          </li>
          <li id='scales' class="list-group-item">
            <div class="list-child practice-type">Scales</div>
            <div class="list-child time-dropdown-group"></div>
          </li>
          <li id='chords' class="list-group-item">
            <div class="list-child practice-type">Chords</div>
            <div class="list-child time-dropdown-group"></div>
          </li>
          <li id='ear_training' class="list-group-item">
            <div class="list-child practice-type">Ear training</div>
            <div class="list-child time-dropdown-group"></div>
          </li>
          <li id='sight_reading' class="list-group-item">
            <div class="list-child practice-type">Sight reading</div>
            <div class="list-child time-dropdown-group"></div>
          </li>
        </ul>
      </div>
      <button class="start btn btn-default btn-lg" type="button">Start</button>
    </div>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
    <script src="/components/bootstrap/dist/js/bootstrap.min.js"></script>
    <script type="text/javascript">
      $(document).ready(function() { $('#main_nav').load('../../main_nav.html'); });
      $(document).ready(function() { $('.time-dropdown-group').load('time_dropdown_group.html'); });

      var keys = [
        'C', 'G', 'D', 'A', 'E', 'B', 'Gb', 'Db', 'Ab', 'Eb', 'Bb', 'F'
      ];

      var practiceTimes = {};
      var practiceTypes = [];
      var practiceTimeMillis;

      function minutesToMillis(minutes) {
        return minutes * 60 * 1000;
      }

      function loadPracticePage(practiceTypeIndex) {
        var practiceType = practiceTypes[practiceTypeIndex];
        practiceTimeMillis = practiceTimes[practiceType];
        $('.main_contents').load(practiceType + '.html');
        if (practiceTypeIndex < practiceTypes.length - 1) {
          setTimeout(function() { loadPracticePage(practiceTypeIndex + 1) }, practiceTimeMillis);
        }
      }

      $('.start').on('click', function() {
        $('.list-group-item').each(function() {
          var practiceType = $(this).attr('id');
          var timeMinutes = +$(this).find('.time-value').text();
          practiceTimes[practiceType] = minutesToMillis(timeMinutes);
          practiceTypes.push(practiceType);
        });

        loadPracticePage(0);
      });
    </script>
  </body>
</html>
