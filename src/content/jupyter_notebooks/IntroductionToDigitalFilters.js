import React from 'react'

import Link from '../Link'
import Paragraph from '../Paragraph'

import './style/jupyter-style.css'
import notch_filter_animation from './assets/intro_to_digital_filters/notch_filter.gif'
import notch_filter_wo_lines_animation from './assets/intro_to_digital_filters/notch_filter_without_lines.gif'

import one_zero_animation from './assets/intro_to_digital_filters/one_zero_filter_animation.gif'
import one_pole_animation from './assets/intro_to_digital_filters/one_pole_filter_animation.gif'
import two_pole_animation from './assets/intro_to_digital_filters/two_pole_filter_animation.gif'
import two_zero_animation from './assets/intro_to_digital_filters/two_zero_filter_animation.gif'
import biquad_section_animation from './assets/intro_to_digital_filters/biquad_section_animation.gif'
import biquad_allpass_section_animation from './assets/intro_to_digital_filters/biquad_allpass_section_animation.gif'
import complex_one_pole_resonator_animation from './assets/intro_to_digital_filters/complex_one_pole_resonator_animation.gif'
import dc_blocker_animation from './assets/intro_to_digital_filters/dc_blocker_filter_animation.gif'

export default (
  <div>
    <Paragraph>
      <Link href="https://colab.research.google.com/github/khiner/notebooks/blob/master/introduction_to_digital_filters/index.ipynb">
        This set of Jupyter notebooks
      </Link>{' '}
      <small>
        (
        <Link href="https://github.com/khiner/notebooks/blob/master/introduction_to_digital_filters/">
          raw Github link
        </Link>
        )
      </small>{' '}
      covers the second book in Julius O. Smith III's excellent four-book series
      on audio DSP,{' '}
      <Link href="https://www.amazon.com/Introduction-Digital-Filters-Audio-Applications/dp/0974560715/">
        Introduction to Digital Filters: with Audio Applications
      </Link>
      . This book takes the concepts from{' '}
      <Link href="https://karlhiner.com/jupyter_notebooks/mathematics_of_the_dft">
        Mathematics of the DFT
      </Link>{' '}
      and runs with it, getting deep into digital filter theory, analysis,
      design and applications.
    </Paragraph>
    <Paragraph>
      The difficulty level goes up quite a bit here - lots of complex analysis
      tricks are used to derive results and a substantial amount of algebraic
      manipulation and creativity in the complex domain is used throughout the
      book, and required to solve the exercises.
    </Paragraph>
    <h3>Analytic vs graphical approaches to understanding filters</h3>
    <Paragraph>
      Readers of this blog will know that I love visualizations, and in this
      domain I especially found that visually exploring the concepts really
      helped to develop my intuition. It's easy to get bogged down trying to
      derive exact analytic solutions for a filter's response. I spent many
      maddening/rewarding hours desperately trying random trig identities for
      half a page to try and get some closed solution, only to find at the end
      that it could have been done in a few steps by using some complex algebra
      trick.
    </Paragraph>
    <Paragraph>
      However, when you step away from the symbolic and analytic approach and
      just start moving the poles and zeros of a filter around and seeing what
      happens, the intimidation wears off a bit and it starts to feel within the
      realm of possibility to maybe actually <i>design</i> a filter response
      using some pretty intuitive visual reasoning.
    </Paragraph>
    <h2>Designing a second-order filter to reject 60 Hz hum</h2>
    <Paragraph>
      For example, say we want to design a filter (as we are asked to do in{' '}
      <Link href="https://colab.research.google.com/github/khiner/notebooks/blob/master/introduction_to_digital_filters/chapter_8_pole_zero_analysis.ipynb#Pole-Zero-Analysis-Problems">
        the first exercise of Chapter 8
      </Link>
      ) to attenuate 60 Hz hum, given a sampling rate of 40 KHz. I'll walk
      through my more analytic attempt at the problem, and then I'll give a
      visual explanation of a more canonical notch filter that cuts past a lot
      of analytic hair-pulling. If you'd like you can also just{' '}
      <a href="#graphical">skip to the graphical approach</a>.
    </Paragraph>

    <h3>An analytic approach</h3>
    <Paragraph>
      <small>
        <i>
          Note: For brevity I'm going to assume some notational and terminology
          knowledge in this section. In the next section, I will back up and
          explain things more fully :)
        </i>
      </small>
    </Paragraph>
    <div
      className="jupyter"
      dangerouslySetInnerHTML={{
        __html: `<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html"><Paragraph>We want our filter to have a zero at 60 Hz. For now, let's consider only FIR filters (with no feedback component). We are given the constraint that the filter must be second-order.  The factored form of a second-order FIR filter is</Paragraph><Paragraph>$H(z) = B(z) = (1 - q_1z^{-1})(1 - q_2z^{-1}) = 1 - (q_1 + q_2)z^{-1} + q_1q_2z^{-2}$,</Paragraph>
<Paragraph>where $q_1$ and $q_2$ are the zeros of the frequency response. If we want the amplitude response to equal zero at normalized frequencies $\\omega_{r1}$ and $\\omega_{r2}$, we can simply choose complex filter coefficients such that $\\frac{q_i}{z} = 1$ when $z = e^{j\\omega_{ri}} \\implies q_i = e^{j\\omega_{ri}}$.</Paragraph><Paragraph>Here is an example for clarity:</Paragraph></div></div></div><div class="cell border-box-sizing code_cell rendered"><div class="input"><div class="prompt input_prompt">In&nbsp;[4]:</div><div class="inner_cell"><div class="input_area"><div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.signal</span> <span class="k">import</span> <span class="n">freqz</span>
</pre></div></div></div></div></div>
<div class="cell border-box-sizing code_cell rendered"><div class="input"><div class="prompt input_prompt">In&nbsp;[5]:</div><div class="inner_cell"><div class="input_area"><div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Pick a couple of arbitrary frequencies to reject.</span>
<span class="n">w1_reject</span> <span class="o">=</span> <span class="mf">0.8</span>
<span class="n">w2_reject</span> <span class="o">=</span> <span class="mf">2.2</span>

<span class="n">N</span> <span class="o">=</span> <span class="mi">512</span>
<span class="n">q1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">w1_reject</span><span class="p">)</span>
<span class="n">q2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">w2_reject</span><span class="p">)</span>

<span class="n">B</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="p">(</span><span class="n">q1</span> <span class="o">+</span> <span class="n">q2</span><span class="p">),</span> <span class="n">q1</span> <span class="o">*</span> <span class="n">q2</span><span class="p">];</span> <span class="n">A</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">w</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="n">freqz</span><span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">worN</span> <span class="o">=</span> <span class="n">N</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">h</span><span class="p">))</span>
<span class="k">for</span> <span class="n">w_reject</span> <span class="ow">in</span> <span class="p">[</span><span class="n">w1_reject</span><span class="p">,</span> <span class="n">w2_reject</span><span class="p">]:</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">w_reject</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
</pre></div></div></div></div><div class="output_wrapper"><div class="output"><div class="output_area"><div class="prompt"></div><div class="output_png output_subarea "><img style="width: 90%" src="data:image/png;base64,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
"></div></div></div></div></div><div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="text_cell_render border-box-sizing rendered_html"><Paragraph>If we only want to reject a single frequency (as in this problem), we can set $q_1 = q_2 = q = e^{j\\omega_{ri}}$, making our expanded general factored transfer function</Paragraph><Paragraph>$H(z) = 1 - 2qz^{-1} + q^2z^{-2}$.</Paragraph></div></div></div><div class="cell border-box-sizing code_cell rendered"><div class="input"><div class="prompt input_prompt">In&nbsp;[6]:</div><div class="inner_cell"><div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Only reject a single frequency with a second-order FIR filter with complex coefficients.</span>
<span class="n">w_reject</span> <span class="o">=</span> <span class="mf">2.2</span>

<span class="n">N</span> <span class="o">=</span> <span class="mi">512</span>
<span class="n">q</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">w_reject</span><span class="p">)</span>

<span class="n">B</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">q</span><span class="p">,</span> <span class="n">q</span> <span class="o">**</span> <span class="mi">2</span><span class="p">];</span> <span class="n">A</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">w</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="n">freqz</span><span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">worN</span> <span class="o">=</span> <span class="n">N</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">h</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">w_reject</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
</pre></div></div></div></div><div class="output_wrapper"><div class="output"><div class="output_area"><div class="prompt"></div><div class="output_png output_subarea ">
<img style="width: 90%" src="data:image/png;base64,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
"></div></div></div></div></div><div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="text_cell_render border-box-sizing rendered_html"><Paragraph>We could technically be done here since the problem doesn't stipulate any more constraints, nor does it stipulate how wide the passband should be. However, I don't think this is what the question is after.</Paragraph></div></div></div><div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="text_cell_render border-box-sizing rendered_html"><Paragraph>If we want a second-order FIR filter with a <em>real</em> coefficient $b_1$ (and $b_2 = 1$), such that the amplitude response is equal to $0$ for normalized frequency $\\omega$, we set the amplitude response to $0$ and solve for $b_1$</Paragraph>
<Paragraph>$\\begin{align}
G(\\omega) = \\left|H(e^{j\\omega T})\\right| &amp;= \\left|1 + b_1e^{-j\\omega T} + e^{-j2\\omega T}\\right|\\\\
0 &amp;= \\left|e^{j2\\omega T} + b_1e^{j\\omega T} + 1\\right|\\\\
\\end{align}$</Paragraph>
<Paragraph>The only way for the magnitude of a complex number to be $0$ is if the complex number itself is $0$. I know it's obvious but I needed to think about this for a while and found out the hard way that this works cleanly after solving with trig by expanding using Euler's identity. Here's a much simpler way:</Paragraph>
<Paragraph>$\\begin{align}
0 &amp;= e^{j2\\omega T} + b_1e^{j\\omega T} + 1\\\\
-e^{j2\\omega T} - 1 &amp;= b_1e^{j\\omega T}\\\\
-\\frac{e^{j2\\omega T} + 1}{e^{j\\omega T}} &amp;= b_1\\\\
-(e^{j\\omega T} + e^{-j\\omega T}) &amp;= b_1\\\\
-2\\cos(\\omega T) &amp;= b_1\\\\
\\end{align}$</Paragraph>
<Paragraph>We are given the sampling interval $T = \\frac{1}{f_s} = \\frac{1}{40k} s$.</Paragraph>
<Paragraph>When $f = 60 Hz$,</Paragraph>
<Paragraph>$\\begin{align}
b_1 &amp;= -2\\cos(\\omega T)\\\\
&amp;= -2\\cos\\left(2\\pi \\frac{60}{40k}\\right)\\\\
&amp;= -2\\cos\\left(\\frac{3\\pi}{1000}\\right)\\\\
\\end{align}$</Paragraph>
<Paragraph>Finally, our naive second-order 60 Hz hum-reject-filter for a sampling rate of $f_s=40$ Khz is</Paragraph>
<Paragraph>$y(n) = x(n) - 2\\cos\\left(\\frac{3\\pi}{1000}\\right)x(n-1) + x(n-2)$.</Paragraph></div></div></div><div class="cell border-box-sizing code_cell rendered"><div class="input"><div class="prompt input_prompt">In&nbsp;[7]:</div><div class="inner_cell"><div class="input_area"><div class=" highlight hl-ipython3"><pre><span></span><span class="n">fs</span> <span class="o">=</span> <span class="mi">40</span><span class="n">_000</span>
<span class="n">B</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">3</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">1000</span><span class="p">),</span> <span class="mi">1</span><span class="p">]</span>

<span class="n">H</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="n">fs</span><span class="p">)</span>

<span class="n">f</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">fs</span> <span class="o">//</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Target reject frequency (60 Hz)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">H</span><span class="p">[:</span><span class="n">fs</span><span class="o">//</span><span class="mi">2</span><span class="p">]))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
</pre></div></div></div></div><div class="output_wrapper"><div class="output"><div class="output_area"><div class="prompt"></div><div class="output_png output_subarea ">
<img style="width: 90%" src="data:image/png;base64,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
"
></div></div></div></div></div><div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="text_cell_render border-box-sizing rendered_html"><Paragraph><strong>How is the frequency response not ideal? What is a simple way to obtain a better frequency response at the price of higher filter order? (Hint: Consider $\\lim_\\limits{M\\to\\infty}\\left|\\cos(\\theta_c)\\right|^M$.)</strong></Paragraph></div></div></div><div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="text_cell_render border-box-sizing rendered_html"><Paragraph>We can see from the plot (and from the equation) that the response is nowhere <em>near</em> flat outside of the "stopband" (nor is it flat anywhere in the spectrum).</Paragraph><Paragraph>Let's get a grip on the hint we're given:</Paragraph></div></div></div><div class="cell border-box-sizing code_cell rendered"><div class="input"><div class="prompt input_prompt">In&nbsp;[8]:</div><div class="inner_cell"><div class="input_area"><div class=" highlight hl-ipython3"><pre><span></span><span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">))</span> <span class="o">**</span> <span class="mi">1000</span><span class="p">)</span>
</pre></div></div></div></div><div class="output_wrapper"><div class="output"><div class="output_area"><div class="prompt"></div><div class="output_png output_subarea ">
<img style="width: 90%" src="data:image/png;base64,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
"
></div></div></div></div></div><div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="text_cell_render border-box-sizing rendered_html"><Paragraph>This tells us that $1 - \\left|\\cos(\\theta_c)\\right|^M$ behaves as what looks like an ideal reject response when $\\theta_c = \\pi$ as $M \\to \\infty$. We can choose any frequency to "notch" here by subtracting it from $\\theta_c$ above. That is, we should be pretty happy with an amplitude response that looks like</Paragraph><Paragraph>$\\begin{align}
G(\\omega) &amp;= 1 - \\left|\\cos(\\omega - \\omega_r)\\right|^M\\\\
\\end{align}$</Paragraph></div></div></div><div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="text_cell_render border-box-sizing rendered_html"><Paragraph>I scratched my head for awhile thinking of how to design a transfer function to match this kind of response. I ended up finding <a href="https://dsp.stackexchange.com/a/31030/1683" target=_blank>this SO answer</a> that helped. (I will discuss this more in the next section).  The constant <code>a</code> in the following implementation controls how close we want to make the frequency response to flat.</Paragraph></div></div></div><div class="cell border-box-sizing code_cell rendered"><div class="input"><div class="prompt input_prompt">In&nbsp;[9]:</div><div class="inner_cell"><div class="input_area"><div class=" highlight hl-ipython3"><pre><span></span><span class="n">fs</span> <span class="o">=</span> <span class="mi">40</span><span class="n">_000</span>

<span class="n">f_r</span> <span class="o">=</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">1000</span>
<span class="n">a</span> <span class="o">=</span> <span class="mf">1.01</span>
<span class="n">B</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">f_r</span><span class="p">),</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">A</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span> <span class="o">*</span> <span class="n">a</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">f_r</span><span class="p">),</span> <span class="n">a</span> <span class="o">**</span> <span class="mi">2</span><span class="p">]</span>
<span class="n">H</span> <span class="o">=</span> <span class="p">((</span><span class="mi">1</span> <span class="o">+</span> <span class="n">a</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="n">fs</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="n">fs</span><span class="p">)</span>

<span class="n">f</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">fs</span> <span class="o">//</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Target reject frequency (60 Hz)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">H</span><span class="p">[:</span><span class="n">fs</span><span class="o">//</span><span class="mi">2</span><span class="p">]))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
</pre></div></div></div></div><div class="output_wrapper"><div class="output"><div class="output_area"><div class="prompt"></div><div class="output_png output_subarea ">
<img style="width: 90%" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAYQAAAEACAYAAACznAEdAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAADl0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uIDIuMS4wLCBodHRwOi8vbWF0cGxvdGxpYi5vcmcvpW3flQAAIABJREFUeJzt3Xt4VfWd7/H3Nzsk4SZigGiJ3JkIagglooJicLTgpaI+jMioI5V6HXwGa+1hrHN0Ol566jnttN764KVoa1XqhYGCN84xBYtFQNEKiCBFCTrcgkAigVy+549sYhJ2kpWdnexk5fN6zJPs37r99teQz/791tprm7sjIiKSkuwOiIhI+6BAEBERQIEgIiJRCgQREQEUCCIiEqVAEBERQIEgIiJRCgQREQEUCCIiEqVAEBERAFKT3YHm6NOnjw8aNCiubUtLS+nevXtiOxQSYa3Nxo0bAcjJyYl7H2GtTSKoNrG1x7qsWbNmt7v3bWq9DhUIgwYNYvXq1XFtW1hYSEFBQWI7FBJhrc2R51RYWBj3PsJam0RQbWJrj3Uxs8+CrNehAkGkOe66665kd0GkQ1EgSGidd955ye6CSIeik8oSWmvXrmXt2rXJ7oZIh6ERgoTW7NmzgZadQxDpTDRCEBERQIEgIiJRmjIS6SDcnYoqp7LKqYr+XBV9XOnR71VOVRXRx1VUVlGzfpU7Rz4x16P7q/5e3VJ3Wd3ljlcvqLX8o92VpHyyq2ZfR5ZxZP2EP/+E77JV9vnXnRWUr9+R8P0O7dudIX17JHy/tSkQRFpRWXkluw4cYnfJIXaXHKa49BAHyiooOVRBSVlFzc8HDlVQdriSQxWVHKqo4nBFFYeiX4ePtFVWtcofsBZZ/W6ye9A+vRff+6Uac8ekHP554rCE77c2BYKE1v33398mx9lTcoj1X+5ny65SPtvzNZ8Xf83nxaV8+VUZBw5VNLhdt7QIPTNS6ZFe/dU1LcKx3dJIT00hLTWF9NQI6V1SSIukkN6l+nFaxEhJMSJmRFK++Uqp/Tj68zfrQYpVr2MGZtXHN4zof5hZ9Ps3yyy6rHqdWo+j669d+z7fHj06uo3V2vab/SWatcJOE93TNWtWM2ZMfsL72u+Y9MTuMAYFgoTWuHHjEr7Pyipn3Rf7+PPmPaz5rJh1X+zny31lNcu7dokwMLMbAzO7M25oH/r2TKdvj3T69EyjT490juueRs+MLvRITyWS0hp/MtvO159FyB90XLK70e7s2Rzh1Oxeye5GXBQIElorVqwAWh4MZeWV/OmTXfzxwy8p3LiTA2XVr/qH9u3O6YOP4+Rv9eLkbx3DsKwe9O2RjrXGy1iRNqBAkNC68847gfjfh7BpxwGeWXeIWW8tpeRQBcd1T+PCU05g/PA+nDkkk749W38IL9KWOkUgvPxeET9eWkpq4etA3XnQ6u/frFt/Wd22+i3UmTc9uq3h9WK9iqzTj2buo37XDEhNSSElxUitmU8+0vbNsojBV3vLeG7b6rrrR+eeIykpdIkY6akpZHSJkNElUvNz7baMLil0S4twTEYXenXtwjFdu5DRJXLUc+wIPtq+j//9xkYKN+4iNQWm5GVz2ej+nDHkOFIjulJbwqtTBMKgPt05q38q2dnZR12l4bUavKat1vJoa+1L8jhqPT+qrbn7qHOZXsz1vE6bH7163efi1fPdFbEuUaxyDlZW1rR9ddD5evfXdS5drKx1OWN5ZRVl5dVXujTnKpe01JRoQKTSq2sX+vRIJ+uYDI7vlUG/nukc3yuDgcd1p3/vru1iPn3n/jL+Y/EGFn3wBcd268Idk3IYUL6N735nVLK7JtImOkUgfHtAb64akU5BwcnJ7kq7VH273glNrufuHK6soqy8ikPlldXfK6q/l1VUUnqogv1lFew/WM6+g+XsP1jO/rLqn/cdLGfrnlJW/q2YfQfL6+w3LZLCwMxuDOnbnZOOP4a8AceSl30svbuntdZTPup5vfL+dv590XrKyiuZNXEYN5wzhGMyulBYWNQmfRBpDzpFIEhimFn1pZCpEejaJe79lJVXsmN/GV/uK+OzPaVs2V3Kll2lbNpZwhvrd9SMQgZldmP8sD6ce1I/xg3tQ9e0xE9BHaqo5H8uWMcLq7eRP7A3P5ua2+pv/hFprxQI0uYyukQYmNmdgZndOWNIZp1lJYcq+LDoK9Zu+4r3PtvLK+9v59mVn9MtLcJFp57AFaedSP7A3oGu5PnP//zPRpfvO1jOzHmrWP3ZXm49dxizz/u7djF1JZIsCgRpV3qkpzJuaB/GDe0DVL+Cf/dvxSz64AsWf/glf1hTRP7A3sw+7+8YPyyz0WDIy8trcNn+snL+6cmVrP9yPw9NH813R30r4c9FpKPRJRPSrqWnRjh7eF9+NnUU7/74PP5jysls/+ogVz+5kplPr+aLrw42uO3SpUtZunTpUe3llVVc//Rq1n+5n0evGqMwEIlSIEiH0T09lWvOHEThHQX8+MIRvPPpHi745XLe2rgz5vr33nsv995771Ht9y3ewMq/FfPg1FGcPzKrtbst0mEkNRDMbIiZPWlmLyazH9KxpKdGuH7CEF6bfTYn9MrgunmreGlNsKuBlm/axbwVW7lu/GAuHd2/lXsq0rHEHQhm9pSZ7TSzj+q1TzazjWa22czmNLYPd9/i7jPj7YN0bgMzu/PyLeMYNzSTH774Aa999GWj6399uII7X/krQ/p050eTc9qolyIdR0tGCPOAybUbzCwCPAJcAIwEppvZSDM71cz+WO+rXwuOLQJAt7RUnrz2NEZlH8vt8z9g886SBtedt2Ir24oPcv/lp3bYd1GLtKa4A8HdlwHF9ZrHApujr/wPA88DU9z9r+5+cb2v2BO/Is2U0SXCY1d/m/QuEea89GGdd2wfUXqogseXbaEgp+9Rl7qKSDWL9Y8n8MZmg4A/uvsp0cdTgcnu/v3o42uA0919VgPbZwL3AecDT7j7AzHWuQG4ASArK2vM888/H1dfS0pK6NFDbziKJSy1+VNROb/56DA3jUrnjBNS+fzzzwEYMGBAzbIfn57B8N7BRwdhqU1rUG1ia491mThx4hp3z29qvaS+D8Hd9wA3NbHOXGAuQH5+vhcUFMR1rOrbM8S3bdiFpTZnVzkrH3qbN7ZX8qNp55BS601mv3r0zwzrl8b3L53QrNtTh6U2rUG1ia0j1yXRVxltB06s9Tg72ibS6iIpxo3nDGHL7lLe3rybRYsWsWjRIrYVf817n3/FP4zJ1mcViDQi0SOEVcBwMxtMdRBcCfxjgo8h0qDJpxxPz4xUFqzdznuP/h8AbsqqvlvpuSfpOgaRxrTkstPngHeAHDMrMrOZ7l4BzAJeBzYA8919XWK6KtK09NQI3xl5PP/v45149MMh/vzpHvr1TGdYv/Y1ryvS3sQ9QnD36Q20LwGWxN0jkRaa8Hd9eOm9Irp270da6Q7e+XQ3Zw3ro+kikSbo5nYSOkcuKz3Usz8pFQfZXXKY0wbrw+BFmqJAkNDp1zOdPj3SKOvWj9SyrwA46fieSe6VSPunm9tJ6JgZI044hm+dPJbLv/fPAAzrp0AQaYoCQUJpaN8ebN93mP1VaWR2T6NXCz7hTaSzUCBIKJ3QK4PSw5X8Zd3fyDomI9ndEekQFAgSSsf3qg6Bv+2rpN8x6UnujUjHoECQUDoyKvBIGlk9NUIQCUKBIKF0Qq9vQkAjBJFgFAgSSsdkfHMSuWeGrq4WCUKBIKFU+03Jht6hLBKEAkFCqXYI6I4VIsEoECScFAIizaZAkFCqM2WkIYJIIAoEEREBFAgSUtbAzyLSMAWChFLtaSLNGIkEo0CQUNIIQaT5FAgSShoViDSfAkFCT1cZiQSjQJBQ0hvTRJpPgSChVPfWFSIShAJBwk9DBJFAFAgiIgIkORDMbISZ/drMXjSzm5PZFwkXTRmJNF/cgWBmT5nZTjP7qF77ZDPbaGabzWxOY/tw9w3ufhNwBTA+3r6I1KeTyiLN15IRwjxgcu0GM4sAjwAXACOB6WY20sxONbM/1vvqF93mEmAxsKQFfRGpQ5+HINJ8cX+UlLsvM7NB9ZrHApvdfQuAmT0PTHH3B4CLG9jPQmChmS0Gfh9vf0RqUwSINF+iP1uwP7Ct1uMi4PSGVjazAuByIJ0GRghmdgNwA0BWVhaFhYVxdaykpCTubcMujLWprPKanz/5ZCOFB7fEtZ8w1iZRVJvYOnJdkvphs+5eCBQ2sc5cYC5Afn6+FxQUxHWswsJC4t027MJYm8oqhzeqX2OclJNDwdgBce0njLVJFNUmto5cl0RfZbQdOLHW4+xom0ibqnNzO80fiQSS6EBYBQw3s8FmlgZcCSxM8DFEmqSTyiLN15LLTp8D3gFyzKzIzGa6ewUwC3gd2ADMd/d1iemqSHC6oZ1I87XkKqPpDbQvQZeQSnuibBAJRLeukNBTHogEo0CQ0NP0kUgwCgQREQEUCNIJaHwgEowCQUJPM0YiwSgQJPQUCCLBKBAk9PTGNJFgFAgiIgIoEKQT0JSRSDAKBBERARQI0gnojWkiwSgQREQEUCBIJ6DxgUgwCgQJPc0YiQSjQJDQ0/sQRIJRIEjoaYQgEowCQUREAAWCdAIaIIgEo0CQ0NOUkUgwCgTpBJQIIkEoEEREBFAgSCegKSORYBQIEnrKA5FgkhoIZlZgZsvN7NdmVpDMvkh46eZ2IsHEHQhm9pSZ7TSzj+q1TzazjWa22czmNLEbB0qADKAo3r6INEZxIBJMagu2nQc8DDxzpMHMIsAjwPlU/4FfZWYLgQjwQL3trwOWu/ufzCwL+DlwVQv6IyIiLRB3ILj7MjMbVK95LLDZ3bcAmNnzwBR3fwC4uJHd7QXS4+2LSGM0YyQSTEtGCLH0B7bVelwEnN7QymZ2OTAJOJbq0UasdW4AbgDIysqisLAwro6VlJTEvW3Yhb02f/3rX4ns2BDXtmGvTUuoNrF15LokOhCaxd1fBl5uYp25wFyA/Px8LygoiOtYhYWFxLtt2IW2Nq8tBmBUbi4FJ/WLaxehrU0CqDaxdeS6JPoqo+3AibUeZ0fbRESknUt0IKwChpvZYDNLA64EFib4GCLNo3MIIoG05LLT54B3gBwzKzKzme5eAcwCXgc2APPdfV1iuioSH+WBSDAtucpoegPtS4AlcfdIJMH0xjSRYHTrCgk9xYFIMEm9ykgk0crLyykqKqKsrIzHLzkBgJ5lO9iwYXdc++vVqxcbNsR3yWrYqTaxJbMuGRkZZGdn06VLl7i2VyBIqBQVFdGzZ08GDRpE+fZ9AAzu052eGfH9Azlw4AA9e/ZMZBdDQ7WJLVl1cXf27NlDUVERgwcPjmsfmjKSUCkrKyMzM1PnDaTTMTMyMzMpKyuLex8KBAmd+mGgaJDOoqUvhBQIIgm0Z88e8vLyyMvL4/jjj6d///41jw8fPtwqx3zvvfd47bXXWrSPyspKzj777Li2ffnll/n4449jLtuxYwennXYao0ePZsWKFS3pYrtSVVXFxIkTKSkpAaC4uJjLL7+ck046ifz8fN59912g+vfh7//+7xk+fDiTJk1i3759R+1r6dKlXHrppXXarr76ahYsWNDg8W+77TaWLVuWwGdUTYEgkkCZmZmsXbuWtWvXctNNN3HbbbfVPE5LS2ty+8rKymYfM2ggVFRUNLgsEomwfPnyZh8bGg+EN998kzFjxvD+++8zbty4Osviea7txaJFi8jPz6dHjx4A3HrrrVxyySV8/PHHrFixgpycHADuu+8+LrjgAjZt2sTZZ5/Nz372s4Qcf9asWTzwQP0bSLecAkGkjXz3u99lzJgxnHzyyTzxxBNA9R/pY489ltmzZ5Obm8u7777LwoULycnJYcyYMdx66601rx5LSkqYMWMGY8eOZfTo0SxatIiDBw/yk5/8hGeffZa8vDxefPHFOsd84oknuPTSS5k4cSKTJk0C4Kc//Sljx44lNzeXn/zkJ3X6cUSsdQB+85vfkJuby6hRo7j55ptZvnw5S5Ys4bbbbiMvL4+tW7fWrLt69WruvPNOXnrppZoRUv3numrVKs455xzGjBnDBRdcwI4dOwBYtWoVubm55OXl8cMf/pC8vLya5zN79uyaY0yePJm3334bgFdffZUzzzyTb3/720ybNo3S0lIAsrOzueeeexg9ejS5ubl88sknQPXJ32uvvZbc3Fxyc3NZsGABc+fO5Yc//GHN/h977DHuuOOOo/5fPvvss0yZMgWoHh2sXLmSGTNmAJCWlkavXr0A+K//+i+uvfZaAK699tpGX/XHsnLlypoR5imnnFJz9dDQoUP58ssv2bVrV7P21yR37zBfY8aM8Xi99dZbcW8bdmGqzfr162t+/mDbXv9g214/cLA87v3t378/7m3vvvtuf/DBB2se79mzx93dS0tLfcSIEV5cXOzl5eUO+EsvvVSzrH///r5161avqqryqVOn+pQpU9zd/Y477vDnnnvO3d2Li4t9+PDhfvDgQX/88cf9X/7lX2L24fHHH/cBAwZ4cXGxu7svXrzYb775Zq+qqvLKykqfNGmS//nPf/by8nLv1atXo+usXbvWc3Jyap7H1q1b3d39qquu8ldeeaXB4x/pW/3nWlZW5meeeabv2rXL3d1/97vf+fXXX+/u7iNHjvS3337b3d1nz57to0aNOmp/7u6TJk3y5cuX+44dO3zChAleWlrq7u733nuv33fffe7u3r9/f3/00Ufd3f2Xv/yl33jjje7u/oMf/MBvv/12d3evqqry4uJi37dvnw8ZMsTLy6t/Z0477bQ6v1NH9O/fv+ZYq1at8jPOOMOvueYaz8vL8xkzZtQsO1JTd/fKykrv3bv3Uft68803/ZhjjvFRo0bVfPXu3fuoms6ePdvnzJlT83jGjBm+YMGCo/YXq7/Aag/wN1aXnUqozfyHi8noEiGS8s3JtiuuuIJbbrmFr7/+mgsvvPCobWbMmMGMGTPYvXs3l112GZFIpGZZS25r/Itf/IKFC6tv7VVUVMSnn35KXl4eaWlpXHbZZQCsX7+enJwcBg4cCMD06dN55pnqz6B64403ePXVV/npT38KVF9R9fnnnzd53O985zv07t27zj5Gjx4NVI86PvnkE8aOHVuzfkPr7N27l2nTpnHccccB1HxvjtrPdcOGDaxbt47zzjsPqJ5Cys7OZvfu3Rw8eJDx48cDcM011/DWW281ut8VK1awfv36mmmpw4cPc9ZZZ9Usv/zyywEYM2YMS5ZU30hh6dKlNa/YzaymRhMmTODVV19lyJAhRCIRRowYcdTx9u/fT7du3YDq0dXq1at56KGHGDNmDDfeeCMPPvggd999d+C6TJw4sc7o4eqrr66z/Pe//z3r1q2rMzXYr18/vvjii8DHCEKBINIGli5dyrJly/jLX/5C165dOeuss2ouD+zatWugq0PcnQULFjB06NA67U2dXOzevXudfdx1113MnDmzzjq1zy80tM4vfvGLJvvYlNrP1d3Jzc096tzF7t0Nv4kwNTWVqqqqmsdHaujuTJ48md/+9rcxt0tPr/78rUgk0ui5FIDvf//7/PznP2fQoEF873vfi7lOSso3s+3Z2dkMGDCA/Px8AKZMmcLcuXOB6nNKu3btom/fvmzfvp0TTjih0WPH8uGHH3LvvfeyfPnyOsctKyuja9euzd5fY3QOQULtyT/8kVff/L8UFhbWfN1yyy0AdOvWrU77ka8jc8F9+vRhyZIldZbFa9++fRx33HF07dqVdevWsWrVqpjrjRw5ko0bN7Jt2zbcnRdeeKFm2aRJk3jooYdqHr///vsA9OzZkwMHDgTqx6RJk3jyySdr5teLioqO+gPc0DrnnnsuL7zwAsXFxQA135tz/PrPdfv27TVX5Bw+fJh169bRp08funbtyjvvvANUz9cfMWjQIN5//33cna1bt7JmzRoAxo0bx5/+9Ce2bNkCQGlpKZs2bWr0+Oeffz6PPPIIUB0oe/fuBWD8+PF8+umn/OEPf2DatGkxtx02bFjN+ZLs7GyysrLYvHkzUD2KHDlyJACXXHIJTz/9NABPP/10zXmHoPbu3cv06dP53e9+R2ZmZp1ln3zyCaecckqz9tcUBYKEXnt4H8JFF13E119/zciRI7nrrrs4/fTYHyTYrVs3Hn74Yc477zzy8/M59thja05Q3n333ZSWlnLqqady8sknc8899wBw7rnn8sEHHzB69OijTirXd+GFFzJ16lTOOOMMTj31VK644oqaSyePvHJvaJ1Ro0bxox/9iAkTJpCXl8e//du/AdXTWvfff/9RJ5Wbkp6ezosvvsgPfvADcnNzGT16NCtXrgSqT17feOON5OXl1XlVfM4559C/f39GjBjB7bffXnOy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
"
></div></div></div></div></div><div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt"></div>`,
      }}
    />
    <h3>
      A graphical approach
      <a id="graphical" href="#graphical"></a>
    </h3>
    <Paragraph>
      In this case, as mentioned above, I managed to find a Stack Overflow
      answer that helped me solve this particular problem. But the help came in
      a fully-formed transfer function,
    </Paragraph>
    <Paragraph>
      {`$\\begin{align}H(z) &= \\frac{1+a}{2}\\frac{(z - e^{j\\omega_n})(z - e^{-j\\omega_n})}{(z - ae^{j\\omega_n})(z - ae^{-j\\omega_n})}\\\\&=\\frac{1+a}{2}\\frac{z^2 - 2z\\cos{\\omega_n} + 1}{z^2 - 2az\\cos{\\omega_n} + a^2}.\\end{align}$`}
    </Paragraph>
    <Paragraph>
      How did they arrive at this somewhat perplexing transfer function? How
      would I be able to come up with a similarly clever formula to solve a
      problem like this? I will get to what I think is a satisfying answer using
      some geometric intuition after a little background!
    </Paragraph>
    <Paragraph>
      Let's start with the{' '}
      <Link href="https://ccrma.stanford.edu/~jos/filters/Transfer_Function_Analysis.html">
        definition of a transfer function
      </Link>
      :
    </Paragraph>
    <blockquote>
      The <i>transfer function</i> of a linear time-invariant discrete-time
      filter is defined as $Y(z)/X(z)$, where $Y(z)$ denotes the $z$ transform
      of the filter output signal $y(n)$, and $X(z)$ denotes the $z$ transform
      of the filter input signal $x(n)$.
    </blockquote>
    <Paragraph>
      Here, $z$ is just any number in the complex plane. However, what we really
      care about is the <i>frequency response</i>, which is only evaluated on
      the unit circle in the $z$ plane. Thus we can set $z$ to{' '}
      {`$e^{j\\omega T}$`}, where {`$\\omega \\triangleq 2\\pi f$`}, $f$ is the
      frequency in Hz, and $T$ is the sampling interval in seconds.
    </Paragraph>
    <Paragraph>
      Now that we only care about the frequency response, we can think of the
      transfer function in more familiar terms, as a{' '}
      <i>ratio of the DFT of the output to the DFT of the input</i>.
    </Paragraph>
    <Paragraph>
      This is a <i>frequency domain</i> interpretation of digital filters. In
      the <i>time domain</i>, for linear time-invariant filters we are always
      simply multiplying the current input $x(n)$, past inputs $x(n - i)$, and
      past outputs $y(n - i)$, by some coefficients $b_i$ and $a_i$. That is,
      any linear time-invariant filter can be formulated as
    </Paragraph>
    <Paragraph>
      {`$y(n) = b_0x(n) + b_1x(n-1) + \\cdots + b_Mx(n-M) - a_1y(n-1) - \\cdots - a_Ny(n-N)$.`}
    </Paragraph>
    <Paragraph>
      JOS provides a{' '}
      <Link href="https://ccrma.stanford.edu/~jos/filters/Z_Transform_Difference_Equations.html#eq:tpseventeen">
        derivation
      </Link>{' '}
      that I won't reproduce here, which uses basic properties of the DFT to
      unite these equations into a factored form expressed in terms of{' '}
      <Link href="https://ccrma.stanford.edu/~jos/filters/Pole_Zero_Analysis_I.html#eq:tffacpz">
        <i>poles</i> $p_i$ and <i>zeros</i> $q_i$
      </Link>{' '}
      (along with some scaling factor $g$):
    </Paragraph>
    <Paragraph>
      {`$H(z) = g\\frac{(1 - q_1z^{-1})(1 - q_2z^{-1})\\cdots(1 - q_Mz^{-1})}{(1 - p_1z^{-1})(1 - p_2z^{-1})\\cdots(1 - p_Nz^{-1})}$`}
    </Paragraph>
    <Paragraph>
      Here we care about the amplitude response,{' '}
      {`$G(\\omega) \\triangleq \\left|H(e^{j\\omega T})\\right|$`}. That is,
      the amplitude response of a filter is defined as the absolute value of its
      transfer function evaluated on the unit circle. I will skip yet another{' '}
      <Link href="https://ccrma.stanford.edu/~jos/filters/Graphical_Amplitude_Response.html">
        derivation
      </Link>{' '}
      to get to the point, which is that we can finally express the amplitude
      reponse of any linear time-invariant filter as
    </Paragraph>
    <Paragraph>
      {`$G(\\omega) = \\left|g\\right|\\frac{\\left|e^{j\\omega T} - q_1\\right| \\cdot \\left|e^{j\\omega T} - q_2\\right| \\cdots \\left|e^{j\\omega T} - q_M\\right|}{\\left|e^{j\\omega T} - p_1\\right| \\cdot \\left|e^{j\\omega T} - p_2\\right| \\cdots \\left|e^{j\\omega T} - p_N\\right|}$,`}
    </Paragraph>
    <Paragraph>
      where, again, $p_i$ is a pole of the filter, $q_i$ is a zero, and $g$ is a
      scaling constant.
    </Paragraph>
    <Paragraph>
      Remember that transfer function in the Stack Overflow answer? Here it is
      again:
    </Paragraph>
    <Paragraph>
      {`$H(z) = \\frac{1+a}{2}\\frac{(z - e^{j\\omega_n})(z - e^{-j\\omega_n})}{(z - ae^{j\\omega_n})(z - ae^{-j\\omega_n})}$`}
    </Paragraph>
    <Paragraph>Taking the amplitude response,</Paragraph>
    <Paragraph>
      {`$\\begin{align}G(\\omega) &\\triangleq \\left|H(e^{j\\omega T})\\right|\\\\ &= \\left|\\frac{1+a}{2}\\right|\\frac{\\left|e^{j\\omega T} - e^{j\\omega_n}\\right|\\left|e^{j\\omega T} - e^{-j\\omega_n}\\right|}{\\left|e^{j\\omega T} - ae^{j\\omega_n}\\right|\\left|e^{j\\omega T} - ae^{-j\\omega_n}\\right|}\\end{align}$`}
    </Paragraph>
    <Paragraph>
      We finally have the tools to interpret this in a visual, geometric way!
      Clearly, that {`$\\frac{1+a}{2}$`} term is our scaling factor $g$. We can
      safely ignore it since it will scale all frequencies the same amount. That{' '}
      {`$\\omega$`} term there is a <i>frequency</i> at which we are evaluating
      the amplitude response of the filter. The {`$\\omega_n$`} term is what the
      Stack Overflow dude decided to use to express the <i>angle</i> of the
      placement of the poles and zeros of our notch filter. Thus, the zeros,{' '}
      {`$q_1 = e^{j\\omega_n}, q_2 = e^{-j\\omega_n}$`} lie{' '}
      <i>exactly on the unit circle</i>, and the poles,{' '}
      {`$p_1 = ae^{j\\omega_n}, p_2 = ae^{-j\\omega_n}$`}, are placed at the
      same angle as the poles, and then "pushed out" by radius $a$.
    </Paragraph>
    <Paragraph>
      Let's see what these poles and zeros look like in the complex plane, and
      their effect on the frequency response, as we change $a$:
    </Paragraph>
    <img
      style={{ width: '75%' }}
      src={notch_filter_wo_lines_animation}
      alt="notch filter animation showing zeros and poles"
    />
    <Paragraph>
      As the poles are moved closer to the zeros, the frequency response
      magnitude increases everywhere <i>except</i> at the angle {`$\\omega_n$`}{' '}
      (and {`$-\\omega_n$`}) at which we've placed our poles and zeros. Which is
      exactly what we want!
    </Paragraph>
    <Paragraph>
      To understand why this is the case, look back at the amplitude response
      (removing the constant scaling factor):
    </Paragraph>
    <Paragraph>
      {`$\\color{red}{G(\\omega)} = \\frac{\\color{orange}{\\left|e^{j\\omega T} - e^{j\\omega_n}\\right|\\left|e^{j\\omega T} - e^{-j\\omega_n}\\right|}}{\\color{blue}{\\left|e^{j\\omega T} - ae^{j\\omega_n}\\right|\\left|e^{j\\omega T} - ae^{-j\\omega_n}\\right|}}$`}
    </Paragraph>
    <Paragraph>
      Here we can see that{' '}
      <font color="red">
        the frequency response magnitude at frequency {`$\\omega$`}
      </font>{' '}
      is given by the product of{' '}
      <font color="orange">
        vector lengths from the zeros to the point {`$e^{j\\omega T}$`}
      </font>{' '}
      on the unit circle, divided by the product of{' '}
      <font color="blue">
        vectors lengths from the poles to that same point
      </font>
      .{' '}
      <small>
        (The phase response is similarly given by the <i>sum</i> of angles of
        the zero vectors, <i>subtracted</i> by the angles of the pole vectors.
        But I won't be discussing phase reponse in this post.)
      </small>
    </Paragraph>
    <Paragraph>
      Let's now see that same animation but with these vectors explicitly drawn.
      The red point in the amplitude response chart is the result of taking the
      ratio of the product of the orange (numerator) vectors over the product of
      the blue (denominator) vectors. The frequency response is obtained by
      finding this ratio for <i>all</i> frequencies (all such points along the
      unit circle).
    </Paragraph>
    <img
      style={{ width: '75%' }}
      src={notch_filter_animation}
      alt="notch filter animation showing zeros and poles with vectors lines for numerator and denominator"
    />
    <Paragraph>
      Since the zeros lie on the unit circle, the response will evaluate to
      exactly $0$ for {`$\\omega = p_n$`}. As the poles get closer to the zeros,
      the difference between the product of the blue vectors and the product of
      the orange vectors gets smaller and smaller, and so their ratio approaches
      $1$. However, until they are exactly equal, the orange (zero) vectors will
      still asymptotically approach $0$ as {`$\\omega \\to p_n$`}, while the
      poles will still have some positive magnitude, resulting in a ratio
      (response magnitude) close to $0$ (and equal to $0$ when{' '}
      {`$\\omega = p_n$`}
      ).
    </Paragraph>
    <Paragraph>
      With this interpretation we've transformed a somewhat abstract mathy goal
      (design a filter that rejects 60 Hz hum) into a problem that, at least for
      me, is much more intuitive:{' '}
      <i>
        How can we arrange points in a 2D plane such that the ratio of
        vector-lengths from those points to the unit circle is near zero at the
        angle corresponding to 60 Hz, but near one everywhere else?
      </i>
    </Paragraph>
    <h2>Visualizations for common audio filters</h2>
    <Paragraph>
      We can deepen our intuition further by moving the poles and zeros of some
      common filter families, and seeing what effect it has on the amplitude,
      phase and impulse responses.{' '}
      <i>
        (The impulse response is the output of the filter when the input is a{' '}
        <i>unit</i> impulse - a single 1 followed by an infinite number of 0's.)
      </i>
    </Paragraph>
    <h3>One-zero filter</h3>
    <img
      style={{ width: '90%' }}
      src={one_zero_animation}
      alt="one-zero filter animation"
    />
    <h3>One-pole filter</h3>
    <img
      style={{ width: '90%' }}
      src={one_pole_animation}
      alt="one-pole filter animation"
    />
    <h3>Two-pole filter</h3>
    <img
      style={{ width: '90%' }}
      src={two_pole_animation}
      alt="two-pole filter animation"
    />
    <h3>Two-zero filter</h3>
    <img
      style={{ width: '90%' }}
      src={two_zero_animation}
      alt="two-zero filter animation"
    />
    <h3>Biquad section</h3>
    <img
      style={{ width: '90%' }}
      src={biquad_section_animation}
      alt="biquad section animation"
    />
    <h3>Biquad allpass section</h3>
    <img
      style={{ width: '90%' }}
      src={biquad_allpass_section_animation}
      alt="biquad allpass section animation"
    />
    <h3>Complex one-pole resonator</h3>
    <img
      style={{ width: '90%' }}
      src={complex_one_pole_resonator_animation}
      alt="complex one-pole resonator animation"
    />
    <h3>DC-blocker</h3>
    <img
      style={{ width: '90%' }}
      src={dc_blocker_animation}
      alt="DC-blocker filter animation"
    />
    <Paragraph>
      The code that created these animations is in the{' '}
      <Link href="https://colab.research.google.com/github/khiner/notebooks/blob/master/introduction_to_digital_filters/appendix_b_elementary_audio_digital_filters.ipynb">
        notebook for Appendix B: Elementary Audio Digital Filters
      </Link>
      . The graphical interpretation of digital filters originally came from{' '}
      <Link href="https://ccrma.stanford.edu/~jos/filters/Graphical_Amplitude_Response.html">
        this section of the book
      </Link>
      .
    </Paragraph>
    <Paragraph>
      I hope playing around with these animations helps someone else feel a
      little less intimidated by digital filters!
    </Paragraph>
  </div>
)
